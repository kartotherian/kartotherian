logging:
  level: info
  name: kartotherian
metrics:
  type: log
num_workers: 1
services:
- conf:
    cors: "*"
    mwapi_req:
      body: "{{ default(request.query, {}) }}"
      headers:
        host: "{{domain}}"
        user-agent: "{{user-agent}}"
      method: post
      uri: http://localhost:8080/w/api.php
    port: 6533
    restbase_req:
      body: "{{request.body}}"
      headers: "{{request.headers}}"
      method: "{{request.method}}"
      query: "{{ default(request.query, {}) }}"
      uri: http://localhost:7231/{{domain}}/v1/{+path}
    sources:
      gen:
        uri: https://maps.wikimedia.org/osm-pbf/{z}/{x}/{y}.pbf
      osm-intl:
        formats:
        - png
        - json
        - headers
        - svg
        - jpeg
        maxheight: 2048
        maxwidth: 2048
        maxzoom: 19
        public: true
        scales:
        - 1.3
        - 1.5
        - 2
        - 2.6
        - 3
        static: true
        uri: vector://
        xml:
          loader: "@kartotherian/osm-bright-style"
        xmlSetParams:
          source:
            ref: gen
    user_agent: kartotherian/MW-Vagrant
    variables: {}
    modules:
    - "tilelive-bridge"
    - "tilelive-vector"
    - "@kartotherian/autogen"
    - "@kartotherian/babel"
    - "@kartotherian/cassandra"
    - "@kartotherian/demultiplexer"
    - "@kartotherian/layermixer"
    - "@kartotherian/overzoom"
    - "@kartotherian/postgres"
    - "@kartotherian/substantial"
    - "@kartotherian/tilelive-http"
    - "tilejson"
  entrypoint:
  module: "./app.js"
  name: kartotherian
worker_heap_limit_mb: 150
